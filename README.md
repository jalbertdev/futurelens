Including search function and optimized